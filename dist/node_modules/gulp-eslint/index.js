"use strict";function gulpEslint(t){function e(e,n){var l=r.executeOnText(e,n).results[0];return t.quiet&&(l=util.filterResult(l,t.quiet)),l}t=util.migrateOptions(t);var r=new CLIEngine(t);return util.transform(function(n,l,i){var u=path.relative(process.cwd(),n.path);n.isNull()?i(null,n):r.isPathIgnored(u)?(r.options.ignore&&t.warnFileIgnored&&(n.eslint=util.createIgnoreResult(n)),i(null,n)):n.isStream()?n.contents=n.contents.pipe(new BufferStreams(function(t,r,l){n.eslint=e(String(r),u),n.eslint.hasOwnProperty("output")&&(r=new Buffer(n.eslint.output),n.eslint.fixed=!0),l(null,r),i(null,n)})):(n.eslint=e(n.contents.toString(),u),n.eslint.hasOwnProperty("output")&&(n.contents=new Buffer(n.eslint.output),n.eslint.fixed=!0),i(null,n))})}var BufferStreams=require("bufferstreams"),PluginError=require("gulp-util").PluginError,CLIEngine=require("eslint").CLIEngine,util=require("./util"),path=require("path");gulpEslint.result=function(t){if("function"!=typeof t)throw new Error("Expected callable argument");return util.transform(function(e,r,n){e.eslint?util.tryResultAction(t,e.eslint,util.handleCallback(n,e)):n(null,e)})},gulpEslint.results=function(t){if("function"!=typeof t)throw new Error("Expected callable argument");var e=[];return e.errorCount=0,e.warningCount=0,util.transform(function(t,r,n){t.eslint&&(e.push(t.eslint),e.errorCount+=t.eslint.errorCount,e.warningCount+=t.eslint.warningCount),n(null,t)},function(r){util.tryResultAction(t,e,util.handleCallback(r))})},gulpEslint.failOnError=function(){return gulpEslint.result(function(t){var e=util.firstResultMessage(t,util.isErrorMessage);if(e)throw new PluginError("gulp-eslint",{name:"ESLintError",fileName:t.filePath,message:e.message,lineNumber:e.line})})},gulpEslint.failAfterError=function(){return gulpEslint.results(function(t){var e=t.errorCount;if(e>0)throw new PluginError("gulp-eslint",{name:"ESLintError",message:"Failed with "+e+(1===e?" error":" errors")})})},gulpEslint.formatEach=function(t,e){return t=util.resolveFormatter(t),e=util.resolveWritable(e),gulpEslint.result(function(r){util.writeResults([r],t,e)})},gulpEslint.format=function(t,e){return t=util.resolveFormatter(t),e=util.resolveWritable(e),gulpEslint.results(function(r){r.length&&util.writeResults(r,t,e)})},module.exports=gulpEslint;