"use strict";var path=require("path"),fs=require("graceful-fs"),gutil=require("gulp-util"),map=require("map-stream"),CleanCSS=require("clean-css"),filesize=require("filesize"),tempWrite=require("temp-write");module.exports=function(e){return map(function(i,r){return i.isNull()?r(null,i):i.isStream()?r(new gutil.PluginError("gulp-cssmin","Streaming not supported")):-1===[".css"].indexOf(path.extname(i.path))?(gutil.log("gulp-cssmin: Skipping unsupported css "+gutil.colors.blue(i.relative)),r(null,i)):void tempWrite(i.contents,path.extname(i.path),function(n,t){return n?r(new gutil.PluginError("gulp-cssmin",n)):void fs.stat(t,function(n,u){return n?r(new gutil.PluginError("gulp-cssmin",n)):(e=e||{},void fs.readFile(t,{encoding:"UTF-8"},function(n,t){if(n)return r(new gutil.PluginError("gulp-cssmin",n));var u=new CleanCSS(e).minify(t).styles;e.showLog&&gutil.log("gulp-cssmin:",gutil.colors.green("âœ” ")+i.relative),i.contents=new Buffer(u),r(null,i)}))})})})};